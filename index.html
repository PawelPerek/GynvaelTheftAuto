<style>*{margin: 0;padding: 0;}canvas {width: 100vw;height: 100vh;display: block;image-rendering: pixelated;cursor: crosshair}img {display: none}</style><canvas width="360" height="400"></canvas><img src="img/bullet.png" id="img_bullet"><img src="img/blood.png" id="img_blood"><img src="img/player.png" id="img_player"><img src="img/npc.png" id="img_npc"><img src="img/cop.png" id="img_cop"><img src="img/car.png" id="img_car"><img src="img/brk.png" id="img_brk"><img src="img/copcar.png" id="img_copcar"><img src="img/map.png" id="img_map"><img src="img/bground.png" id="img_bground"><img src="img/db.png" id="img_durability"><img src="img/hp.png" id="img_hp"><script>function main(){g=new G([[41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41],[41,1,1,34,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,3,3,3,3,3,3,3,3,3,3,3,3,1,1,34,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,41],[41,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,41],[41,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,33,1,1,1,1,1,1,1,1,1,1,1,1,1,1,33,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,33,41],[41,5,7,1,40,39,39,39,39,39,39,39,39,39,39,39,1,7,4,40,39,39,39,39,39,39,39,39,39,39,39,5,7,4,40,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,38,1,7,4,40,21,22,23,24,23,24,23,24,23,24,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,11,11,11,11,9,9,38,1,7,4,40,25,26,27,28,27,28,27,28,27,28,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,11,11,11,9,11,9,9,38,1,7,4,40,21,22,9,9,9,9,9,9,21,22,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,11,11,9,11,11,11,9,9,38,1,7,4,40,25,26,9,9,9,9,9,9,25,26,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,11,9,9,9,9,11,11,9,38,1,7,4,40,21,22,9,9,9,9,9,9,21,22,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,38,1,7,4,40,25,26,9,9,9,9,9,9,25,26,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,38,1,7,4,40,21,22,23,24,23,24,23,24,23,24,38,5,7,4,40,9,9,9,13,14,13,14,9,9,9,9,15,16,15,16,9,9,9,9,17,18,17,18,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,12,12,12,9,9,9,9,38,1,7,4,40,25,26,27,28,27,28,27,28,27,28,38,5,7,4,40,9,9,9,13,14,13,14,9,9,9,9,15,16,15,16,9,9,9,9,17,18,17,18,9,38,1,7,4,41],[41,5,7,1,40,9,9,12,12,12,12,12,9,9,9,38,1,7,4,37,37,37,37,37,37,37,37,37,37,37,38,5,7,4,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,1,7,4,41],[41,5,7,1,40,9,9,12,12,12,12,12,9,9,9,38,1,1,34,3,3,3,3,3,3,3,3,3,3,3,3,1,1,34,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,41],[41,5,7,1,40,9,9,12,12,12,12,12,9,9,9,38,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,41],[41,5,7,1,40,9,9,12,12,12,12,12,9,9,9,38,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,33,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,36,1,33,41],[41,5,7,1,40,9,9,12,12,12,12,9,9,9,9,38,1,7,4,40,39,39,39,39,39,39,39,39,39,39,39,5,7,4,40,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,1,7,4,41],[41,5,7,1,40,9,9,12,12,12,12,9,9,9,9,38,1,7,4,40,21,22,23,24,23,24,23,24,23,24,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,12,12,12,12,9,9,9,9,38,1,7,4,40,25,26,27,28,27,28,27,28,27,28,38,5,7,4,40,9,9,9,11,11,11,11,11,11,9,9,9,9,9,9,11,11,11,11,11,11,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,12,12,12,9,9,9,9,38,1,7,4,40,21,22,9,9,9,9,9,9,21,22,38,5,7,4,40,9,9,9,11,12,12,12,12,11,9,9,9,9,9,9,11,12,12,12,12,11,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,38,1,7,4,40,25,26,9,9,9,9,9,9,25,26,38,5,7,4,40,9,9,9,11,12,12,12,12,11,9,9,9,9,9,9,11,12,12,12,12,11,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,11,11,9,9,9,11,11,11,11,38,1,7,4,40,21,22,9,9,9,9,9,9,21,22,38,5,7,4,40,9,9,9,11,12,12,12,12,11,9,9,9,9,9,9,11,12,12,12,12,11,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,11,11,11,11,11,11,11,11,9,38,1,7,4,40,25,26,9,9,9,9,9,9,25,26,38,5,7,4,40,9,9,9,11,12,12,12,12,11,9,11,11,11,11,9,11,12,12,12,12,11,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,11,11,11,11,11,11,11,9,9,38,1,7,4,40,23,24,23,24,23,24,23,24,21,22,38,5,7,4,40,9,9,9,11,11,11,11,11,11,9,11,30,29,11,9,11,11,11,11,11,11,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,38,1,7,4,40,27,28,27,28,27,28,27,28,25,26,38,5,7,4,40,9,9,9,9,9,9,9,9,9,9,11,31,32,11,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,37,37,37,37,37,37,37,37,37,37,37,38,1,7,4,37,37,37,37,37,37,37,37,37,37,37,38,5,7,4,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,1,7,4,41],[41,35,1,34,3,3,3,3,3,3,3,3,3,3,3,3,1,1,34,3,3,3,3,3,3,3,3,3,3,3,3,35,1,34,3,3,3,3,3,3,3,3,3,3,3,3,1,1,1,3,3,3,3,3,3,3,3,3,3,3,1,1,1,41],[41,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,1,1,1,41],[41,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,36,1,33,2,2,2,2,2,2,2,2,2,2,2,2,1,1,33,2,2,2,2,2,2,2,2,2,2,2,2,1,1,33,2,2,2,2,2,2,2,2,2,2,2,36,1,33,41],[41,5,7,1,40,39,39,39,39,39,39,39,39,39,39,39,5,7,4,40,39,39,39,39,39,39,39,39,39,39,39,5,7,4,40,39,39,39,39,39,39,39,39,39,39,39,5,7,4,40,39,39,39,39,39,39,39,39,39,39,1,7,4,41],[41,5,7,1,40,10,10,10,10,10,10,10,10,10,10,38,5,7,4,40,10,10,10,10,10,10,10,10,10,10,38,5,7,4,40,10,10,10,10,10,10,10,10,10,10,38,5,7,4,40,10,10,10,10,10,10,10,10,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,9,10,38,5,7,4,40,10,9,9,9,9,9,9,9,10,38,1,7,4,41],[41,5,7,1,40,10,10,10,10,10,10,10,10,10,10,38,5,7,4,40,10,10,10,10,10,10,10,10,10,10,38,5,7,4,40,10,10,10,10,10,10,10,10,10,10,38,5,7,4,40,10,10,10,10,10,10,10,10,10,38,1,7,4,41],[41,5,7,1,37,37,37,37,37,37,37,37,37,37,37,38,5,7,4,37,37,37,37,37,37,37,37,37,37,37,38,5,7,4,37,37,37,37,37,37,37,37,37,37,37,38,5,7,4,37,37,37,37,37,37,37,37,37,37,38,1,7,4,41],[41,35,1,34,3,3,3,3,3,3,3,3,3,3,3,3,35,1,1,3,3,3,3,3,3,3,3,3,3,3,3,35,1,1,3,3,3,3,3,3,3,3,3,3,3,3,35,1,1,3,3,3,3,3,3,3,3,3,3,3,1,1,1,41],[41,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,6,6,6,6,6,6,6,6,6,6,6,1,1,1,41],[41,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,1,1,1,2,2,2,2,2,2,2,2,2,2,2,36,1,33,41],[41,5,7,1,40,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,39,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,19,20,9,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,40,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,9,1,1,1,9,9,9,9,38,1,7,4,41],[41,5,7,1,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,37,38,1,7,4,41],[41,35,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,41],[41,1,1,1,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,1,1,1,41],[41,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,36,1,1,41],[41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41,41]]),g.go()}let g;Number.prototype.a=function(n,t){return this>=n&&this<=t},Number.prototype.b=function(){return 180*this/Math.PI},Number.prototype.c=function(){return this*Math.PI/180};class A{constructor(n){let t=this,i={x:0,y:0},e=Math.floor(Math.random()*n.b.length);t.x=32*n.b[e][0]+8,t.y=32*n.b[e][1]+8,t.a=!1,t.b=!1,t.c=!1,t.d=!1,document.addEventListener("mousemove",n=>{i.x=n.pageX/innerWidth*444.6,i.y=n.pageY/innerHeight*250}),t.z={x:0,y:0},t.img=img_player;let a={left:!1,right:!1,up:!1,down:!1};t.hp=100,t.shoot=!1,t.snd_step=new L(n),t.snd_shoot=new K(n),document.addEventListener("keydown",n=>{"w"==n.key&&(a.up=!0),"s"==n.key&&(a.down=!0),"a"==n.key&&(a.left=!0),"d"==n.key&&(a.right=!0)}),document.addEventListener("keyup",n=>{"w"==n.key&&(a.up=!1),"s"==n.key&&(a.down=!1),"a"==n.key&&(a.left=!1),"d"==n.key&&(a.right=!1)}),document.addEventListener("keydown",i=>{if("f"==i.key)if(t.c)"number"==typeof t.car_id?n.k[t.car_id].get_outside():n.g[t.cop_id].get_outside();else{let i=n.u(t.x,t.y,1e5);"number"==typeof i&&(t.car_id=i,n.k[i].get_inside())}}),document.addEventListener("mousedown",n=>{t.shoot=!0}),document.addEventListener("mouseup",n=>{t.shoot=!1}),t.q=a,t.mouse=i,t.g=n}hit(){this.hp-=33}update(){let n=this;if(n.hp<0?g.o=!0:n.hp<100&&(n.hp+=.2),!n.c){let t=g.c;let i=n.q,e=n.mouse,a=!1;i.up&&(n.y-=1,a=!0,(g.z(n.x,n.y,10,10)||g.s(n.x,n.y,null)||g.s(n.x+10,n.y,null)||g.s(n.x,n.y+10,null)||g.s(n.x+10,n.y+10,null))&&(n.y+=1)),i.down&&(n.y+=1,a=!0,(g.z(n.x,n.y,10,10)||g.s(n.x,n.y,null)||g.s(n.x+10,n.y,null)||g.s(n.x,n.y+10,null)||g.s(n.x+10,n.y+10,null))&&(n.y-=1)),i.left&&(n.x-=1,a=!0,(g.z(n.x,n.y,10,10)||g.s(n.x,n.y,null)||g.s(n.x+10,n.y,null)||g.s(n.x,n.y+10,null)||g.s(n.x+10,n.y+10,null))&&(n.x+=1)),i.right&&(n.x+=1,a=!0,(g.z(n.x,n.y,10,10)||g.s(n.x,n.y,null)||g.s(n.x+10,n.y,null)||g.s(n.x,n.y+10,null)||g.s(n.x+10,n.y+10,null))&&(n.x-=1)),a&&!n.b&&(n.snd_step.update(),n.b=!0,setTimeout(()=>{n.b=!1},500)),n.shoot&&(n.a||(new F(n.g,n),n.snd_shoot.update(),n.a=!0,setTimeout(()=>{n.a=!1},100)));let s={x:n.z.x+5-e.x,y:n.z.y+5-e.y},o=Math.atan2(s.y,s.x);n.x>180?n.z.x=180:n.z.x=n.x,n.y>100?n.z.y=100:n.z.y=n.y,n.angle=o,n.snd_shoot.play(),n.snd_step.play(),t.save(),t.translate(n.z.x+5,n.z.y+5),t.rotate(o),t.drawImage(n.img,-5,-5),t.restore()}}}class C{constructor(n){let t=this;t.v=0,t.durability=100,t.broken=!1,t.i=0;let i=Math.floor(Math.random()*n.d.length);t.x=32*n.d[i][0],t.y=32*n.d[i][1],2==n.p(t.x,t.y)?t.angle=90:3==n.p(t.x,t.y)?t.angle=270:4==n.p(t.x,t.y)?t.angle=360:t.angle=180,t.img=img_car,t.driver_inside=!0,t.player_inside=!1,t.z={x:0,y:0};let e={left:!1,right:!1,up:!1,down:!1};t.i=0,document.addEventListener("keydown",n=>{t.player_inside&&("w"==n.key&&(e.up=!0),"s"==n.key&&(e.down=!0),"a"==n.key&&(e.left=!0),"d"==n.key&&(e.right=!0))}),document.addEventListener("keyup",n=>{t.player_inside&&("w"==n.key&&(e.up=!1),"s"==n.key&&(e.down=!1),"a"==n.key&&(e.left=!1),"d"==n.key&&(e.right=!1))}),t.snd=new I(n),t.g=n,t.q=e}hit(){this.durability-=5}get_inside(){let n=this;n.g.a.d=!0,n.g.a.c=!0,n.driver_inside=!1,n.player_inside=!0}get_outside(){let n=this;n.g.a.c=!1,n.player_inside=!1}empty(){let n=this;g.y(n)&&(n.v=-n.v,n.durability-=Math.abs(n.v)),n.q.left=!1,n.q.right=!1,n.q.up=!1,n.q.down=!1,g.a.x>180&&(n.o.x=g.a.x-180),g.a.y>100&&(n.o.y=g.a.y-100)}ai(){let n=this;g.a.x>180&&(n.o.x=g.a.x-180),g.a.y>100&&(n.o.y=g.a.y-100),n.v=1;let t=g.s(n.x+55*Math.sin(n.angle.c()),n.y-55*Math.cos(n.angle.c()),2,2)||g.q(n.x+35*Math.sin(n.angle.c()),n.y+10-35*Math.cos(n.angle.c()),2,2),i=g.s(n.x+5+45*Math.sin(n.angle.c()),n.y+5-45*Math.cos(n.angle.c()),2,2)||g.q(n.x+5+30*Math.sin(n.angle.c()),n.y+15-30*Math.cos(n.angle.c()),2,2),e=g.s(n.x+10+35*Math.sin(n.angle.c()),n.y+10-35*Math.cos(n.angle.c()),2,2)||g.q(n.x+10+25*Math.sin(n.angle.c()),n.y+20-25*Math.cos(n.angle.c()),2,2),a=g.s(n.x+15+45*Math.sin(n.angle.c()),n.y+15-45*Math.cos(n.angle.c()),2,2)||g.q(n.x+15+30*Math.sin(n.angle.c()),n.y+25-30*Math.cos(n.angle.c()),2,2),s=g.s(n.x+20+55*Math.sin(n.angle.c()),n.y+20-55*Math.cos(n.angle.c()),2,2)||g.q(n.x+20+35*Math.sin(n.angle.c()),n.y+30-35*Math.cos(n.angle.c()),2,2);(t||i||e||a||s)&&(n.v=0);if(n.turning)1==n.v&&(n.turning_right?(n.angle-=.9,90==Math.round(n.angle)&&(n.angle=90,n.turning=!1,n.turning_right=!1)):n.turning_left?(n.angle-=.9,270==Math.round(n.angle)&&(n.angle=270,n.turning=!1,n.turning_left=!1)):n.turning_top?(n.angle-=.9,0==Math.round(n.angle)&&(n.angle=360,n.turning=!1,n.turning_top=!1)):n.turning_down&&(n.angle-=.9,180==Math.round(n.angle)&&(n.angle=180,n.turning=!1,n.turning_down=!1)));else{let t=g.p(n.x+10,n.y+15);33==t&&360==n.angle?(n.turning=!0,n.turning_left=!0):34==t&&270==n.angle?(n.turning=!0,n.turning_down=!0):35==t&&180==n.angle?(n.turning=!0,n.turning_right=!0):36==t&&90==n.angle&&(n.turning=!0,n.turning_top=!0)}}player(){let n=this;g.y(n)&&(n.durability-=Math.abs(n.v),n.v=-n.v),n.x>180?n.z.x=180:n.z.x=n.x,n.y>100?n.z.y=100:n.z.y=n.y,g.a.x=n.x,g.a.y=n.y}broke(){let n=this;n.img=img_brk,n.v=0,n.driver_inside=!1,n.player_inside&&n.get_outside(),n.broken=!0}update(){let n=this;n.durability<0&&n.broke(),n.broken&&n.i++;let t=g.t(n);"number"==typeof t&&g.h[t].die();const i=.02*(Math.cos(1*n.v/2)+1);let e=g.c;n.o={x:0,y:0},g.a.x>180&&(n.o.x=g.a.x-180),g.a.y>100&&(n.o.y=g.a.y-100),n.z={x:n.x-n.o.x,y:n.y-n.o.y},n.driver_inside?n.ai():n.player_inside?n.player():n.empty(),n.x+=Math.sin(n.angle.c())*n.v,n.y-=Math.cos(n.angle.c())*n.v;let a=n.q;a.up&&n.v<4?n.v>=0?n.v+=.01:n.v+=.03:a.down&&n.v>-1?n.v>=0?n.v-=.03:n.v-=.01:n.v>0?n.v-=.01:n.v+=.01,a.right&&(n.angle+=(i*n.v).b()),a.left&&(n.angle-=(i*n.v).b()),n.audio(),n.addition(),e.save(),e.translate(n.z.x+9,n.z.y+20),e.rotate(n.angle.c()),e.drawImage(n.img,-9,-20),e.restore()}audio(){let n=this;if(n.snd){n.snd.play(n.v);let t=n.x-g.a.x,i=n.y-g.a.y;n.snd.vol(.1-.01*Math.sqrt(t*t+i*i))}}addition(){}}class B{constructor(n){let t=this,i=Math.floor(Math.random()*n.b.length);t.x=32*n.b[i][0]+11,t.y=32*n.b[i][1]+11,t.dead=!1,t.img=img_npc,t.angle=0}die(n){let t=this;g.a.d=!0,t.dead=!0,t.img=img_blood,t.id=n,t.i=0}update(){let n=this;if(n.dead)n.i++;else{let t=g.p(n.x-10,n.y-10),i=g.p(n.x+20,n.y+20);37==i?40==t?n.y+=.4:n.x+=.4:38==i?37==t?n.x+=.4:n.y-=.4:39==t?38==i?n.y-=.4:n.x-=.4:40==t&&(39==i?n.x-=.4:n.y+=.4)}n.o={x:0,y:0},g.a.x>180&&(n.o.x=g.a.x-180),g.a.y>100&&(n.o.y=g.a.y-100),n.z={x:n.x-n.o.x,y:n.y-n.o.y},g.c.drawImage(n.img,n.z.x,n.z.y)}}class F{constructor(n,t){let i=this;i.x=t.x+4,i.y=t.y+4,i.angle=t.angle+1.5*Math.PI,i.x+=10*Math.sin(i.angle),i.y-=10*Math.cos(i.angle),i.img=img_bullet,i.z={},i.o={x:0,y:0},i.q=!0,n.l.push(i),i.i=0}update(){let n=this;++n.i>50&&(n.q=!1);let t=g.r(n.x,n.y,!0);if("number"==typeof t)g.h[t].die(),n.q=!1;else{let t=g.s(n.x,n.y);if("number"==typeof t)g.k[t].hit(),n.q=!1;else{let t=g.z(n.x,n.y,2,2);if(t)n.q=!1;else{let t=g.q(n.x,n.y);t&&(g.a.hit(),n.q=!1)}}}n.x+=10*Math.sin(n.angle),n.y-=10*Math.cos(n.angle),g.a.x>180&&(n.o.x=g.a.x-180),g.a.y>100&&(n.o.y=g.a.y-100),n.z={x:n.x-n.o.x,y:n.y-n.o.y},g.c.drawImage(n.img,n.z.x,n.z.y)}}class D extends C{constructor(n){super(n);let t=this;t.img=img_copcar,t.snd=new J(n),t.g=n}ai(){let n=this,t=n.x-g.a.x,i=n.y-g.a.y;i*i+t*t<1e4&&n.cop_get_out()}cop_get_out(){let n=this;n.driver_inside=!1,n.c1=new E(n.g,n.x,n.y+10),n.c2=new E(n.g,n.x,n.y-10),g.g.push(n.c1,n.c2)}}class E extends B{constructor(n,t,i){super(n);let e=this;e.x=t,e.o={},e.z={},e.y=i,e.img=img_cop,e.cd=!1,e.g=n}update(){let n=this;if(n.dead)n.i++;else{let t=n.x-g.a.x,i=n.y-g.a.y,e=i*i+t*t;if(e<1e4){let t={x:n.z.x+5-(g.a.z.x+5),y:n.z.y+5-(g.a.z.y+5)};n.angle=Math.atan2(t.y,t.x),n.cd||(new F(n.g,n),n.cd=!0,setTimeout(()=>{n.cd=!1},500))}}g.a.x>180&&(n.o.x=g.a.x-180),g.a.y>100&&(n.o.y=g.a.y-100),n.z={x:n.x-n.o.x,y:n.y-n.o.y},g.c.drawImage(n.img,n.z.x,n.z.y)}}class H{constructor(n){let t=this,i=new(window.AudioContext||window.webkitAudioContext),e=i.createGain(),a=i.createOscillator();a.connect(e),e.connect(i.destination),e.gain.value=0,a.frequency.value=1500,a.start(),a.type="square",t.i=0,t.j=200,t.c=i,t.gain=e,t.osc=a}vol(n){n>0||(n=0),this.gain.gain.value=n}stop(){this.osc.stop()}}class I extends H{constructor(n){super()}play(n){this.osc.type="square",this.osc.frequency.value=100*Math.sin(++this.i*Math.PI/2)+100*n}}class J extends H{constructor(n){super()}play(){this.osc.type="square",this.osc.frequency.value=700*Math.cos(50*++this.i)+1500}}class K extends H{constructor(n){super()}play(){this.gain.gain.value=this.i,this.osc.frequency.value=this.j,this.i>0?this.i-=.05:this.i=0,this.j-=6}update(){this.gain.gain.value=.1,this.osc.frequency.value=100,this.i=this.gain.gain.value,this.j=this.osc.frequency.value}}class L extends H{constructor(n){super()}play(){this.gain.gain.value=this.i,this.osc.frequency.value=this.j,this.i>0?this.i-=.01:this.i=0,this.j-=3}update(){this.gain.gain.value=.05,this.osc.frequency.value=200,this.i=this.gain.gain.value,this.j=this.osc.frequency.value}}class G{constructor(n){let t=this;t.a=document.querySelector("canvas"),t.c=t.a.getContext("2d",{alpha:!1}),t.b=[],t.d=[],t.f=[],t.c.scale(.81,1.6),t.c.imageSmoothingEnabled=!1,t.e=[],t.g=[],t.h=[],t.i=[],t.j=[],t.k=[],t.l=[],t.m=n;for(let[i,e]of n.entries())for(let[n,a]of e.entries())a.a(37,40)?(t.b.push([n,i]),a=8):a.a(2,5)?(t.d.push([n,i]),a=1):a.a(33,36)&&(a=1),t.f.push(()=>{let e={x:0,y:0};t.a.x>180&&(e.x=t.a.x-180),t.a.y>100&&(e.y=t.a.y-100),t.c.drawImage(img_map,32*(a-1),0,32,32,32*n-e.x,32*i-e.y,32,32)});t.a=new A(t),t.n={a(){let n=new C(t);t.i.push(n)},b(){let n=new B(t);t.e.push(n)},c(){let n=new D(t);t.j.push(n)}}}p(n,t){return this.m[(t-t%32)/32][(n-n%32)/32]}go(){let n=this;if(n.o)n.c.fillStyle="red",n.c.fillRect(0,0,500,500);else{n.c.drawImage(img_bground,0,0);for(let t of n.f)t(n.c);for(;n.i.length<25;)n.n.a();for(;n.e.length<25;)n.n.b();if(n.a.d)for(;n.j.length<25;)n.n.c();n.k=n.i.concat(n.j),n.h=n.e.concat(n.g),n.a.update();for(let[t,i]of n.h.entries())i.update(),i.dead&&i.i>100&&(t<25?n.e.splice(t,1):n.g.splice(t-25,1));for(let[t,i]of n.k.entries())i.update(),i.broken&&i.i>100&&(t<25?n.i.splice(t,1):n.j.splice(t-25,1));for(let[t,i]of n.l.entries())i.update(),i.q||n.l.splice(t,1);n.c.drawImage(img_hp,10,10,Math.round(n.a.hp/100*100),5),n.a.c&&n.c.drawImage(img_durability,10,20,Math.round(n.k[n.a.car_id].durability/100*100),5)}requestAnimationFrame(n.go.bind(n))}q(n,t){if(n.a(this.a.x,this.a.x+8)&&t.a(this.a.y,this.a.y+8))return!0}r(n,t,i){let e=this.w(n,t,i);if("number"==typeof e){let i=this.h[e];if(n.a(i.x,i.x+10)&&t.a(i.y,i.y+10))return e}return!1}s(n,t,i){let e=this.u(n,t,null,null,i);if("number"==typeof e){let i=this.k[e],a=this.c;a.save(),a.translate(i.x+9,i.y+20),a.rotate(i.angle.c());let s=a.getTransform().invertSelf();a.restore();let g=new DOMPoint(.81*n,1.6*t),o=s.transformPoint(g);if(o.x.a(-9,11)&&o.y.a(-20,11))return e}return!1}t(n){let{x:x,y:y,angle:angle}=n,t=this.w(x,y,!0);if("number"==typeof t){let n=this.h[t],i=this.c;i.save(),i.translate(x+9,y+20),i.rotate(angle.c());let e=i.getTransform().invertSelf();i.restore();let a=new DOMPoint(.81*(n.x+5),1.6*(n.y+5)),s=e.transformPoint(a);return!(!s.x.a(-9,11)||!s.y.a(-20,11))&&t}}u(n,t,i,e,a){let s={dist:Number.MAX_SAFE_INTEGER,id:null};for(let[g,o]of this.k.entries())if(o!=a)if(e&&!o.broken){let e=n-o.x,a=t-o.y,u=a*a+e*e;i?u<s.dist&&u<i&&(s={dist:u,id:g}):u<s.dist&&(s={dist:u,id:g})}else{let e=n-o.x,a=t-o.y,u=a*a+e*e;i?u<s.dist&&u<i&&(s={dist:u,id:g}):u<s.dist&&(s={dist:u,id:g})}return s.id}w(n,t,i){let e={dist:Number.MAX_SAFE_INTEGER,id:null};for(let[a,s]of this.h.entries())if(i&&!s.dead){let i=n-s.x,g=t-s.y,o=g*g+i*i;o<e.dist&&(e={dist:o,id:a})}return e.id}y(n){let{x:x,y:y}=n,t=x+9,i=y+20,e=x-t,a=y-i,s=[{x:e*Math.cos(n.angle.c())-a*Math.sin(n.angle.c())+x+9,y:e*Math.sin(n.angle.c())+a*Math.cos(n.angle.c())+y+20},{x:(e+20)*Math.cos(n.angle.c())-a*Math.sin(n.angle.c())+x+9,y:(e+20)*Math.sin(n.angle.c())+a*Math.cos(n.angle.c())+y+20},{x:e*Math.cos(n.angle.c())-(a+29)*Math.sin(n.angle.c())+x+9,y:e*Math.sin(n.angle.c())+(a+29)*Math.cos(n.angle.c())+y+20},{x:(e+20)*Math.cos(n.angle.c())-(a+29)*Math.sin(n.angle.c())+x+9,y:(e+20)*Math.sin(n.angle.c())+(a+29)*Math.cos(n.angle.c())+y+20}],g=[this.p(s[0].x,s[0].y),this.p(s[1].x,s[1].y),this.p(s[2].x,s[2].y),this.p(s[3].x,s[3].y)];const o=[10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,41];for(let n of g)if(o.includes(n))return!0;g=[this.s(s[0].x,s[0].y,n),this.s(s[1].x,s[1].y,n),this.s(s[2].x,s[2].y,n),this.s(s[3].x,s[3].y,n)];for(let n of g)if("number"==typeof n)return!0;return!1}z(n,t,i,e){if(t){let a=[{x:n,y:t},{x:n+i,y:t},{x:n,y:t+e},{x:n+i,y:t+e}],s=[this.p(a[0].x,a[0].y),this.p(a[1].x,a[1].y),this.p(a[2].x,a[2].y),this.p(a[3].x,a[3].y)];const g=[10,11,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,41];for(let n of s)if(g.includes(n))return!0;return!1}}}main();</script>